{"version":3,"file":"bundle.js","sources":["../src/lib/step_options.js","../src/lib/get_key.js","../src/index.js"],"sourcesContent":["function stepOption(opts, options, step, self){\n    opts[step] = {};\n    let range = options.range;\n    let wrap = options.wrap;\n    Object.defineProperties(opts[step], {\n        range: {\n            set(v){\n                range = v;\n            },\n            get(){\n                return range || self.range;\n            }\n        },\n        wrap: {\n            set(v){\n                wrap = v;\n            },\n            get(){\n                return wrap || self.wrap;\n            }\n        }\n    });\n    return opts;\n}\n\nexport default function createStepOptions(options, self){\n    let opts = {};\n    stepOption(opts, options, 'down', self);\n    stepOption(opts, options, 'up', self);\n    stepOption(opts, options, 'left', self);\n    stepOption(opts, options, 'right', self);\n    return options;\n}\n","let keySet = {\n    '37': 'left',\n    '38': 'up',\n    '39': 'right',\n    '40': 'down'\n};\n\nexport default function getKey(keyCode){\n    return keySet[keyCode] || null;\n}\n","import events from 'dom-eve';\nimport domStep from 'dom-step';\nimport arrayFrom from 'array-from';\nimport getCorner from 'dom-get-corner';\nimport getElement from 'dom-get-element';\nimport createStepOptions from './lib/step_options.js';\nimport getKey from './lib/get_key.js';\n\nfunction isEdge(el, child){\n    if(el.children[el.children.length - 1] === child){\n        return 'last';\n    }else if(el.children[0] === child){\n        return 'first';\n    }\n    return null;\n}\n\nclass DOMArrowSelect {\n    constructor({\n        step = {},\n        selectID = 'dom-arrow-select-selected',\n        selected = function(next, prev){\n            this.unSelect(prev);\n            this.select(next);\n        },\n        range = 1,\n        wrap = 5\n    } = {}){\n\n        this.range = range;\n        this.wrap = wrap;\n        this.element = null;\n        this.current = null;\n        this.selectID = selectID;\n\n        this.step = createStepOptions(step, this);\n\n        const tracker = this.tracker = events.track();\n\n        events(document, tracker).on('keyup', event=>{\n            let element = this.element;\n            let key = getKey(event.which || event.keyCode);\n\n            if(key){\n                let el = this.current;\n                let next = null;\n                if(!el){\n                    next = getCorner(element, key, {\n                        reverse:true,\n                        xrange: this.step[key].wrap,\n                        yrange: this.step[key].wrap\n                    });\n                }else{\n                    next = domStep(el, key, this.step[key]);\n                }\n\n                if(next){\n                    //The parent is in the document\n                    if(element.parentNode){\n                        selected.call(this, next, this.current, isEdge(element, next));\n                    }\n                }\n            }\n        });\n\n        this.destroy = function(){\n            tracker.clear();\n        };\n    }\n    focus(element){\n        this.element = getElement(element);\n        return this;\n    }\n    unSelect(child){\n        if(child === null) return this;\n        child = getElement(child);\n\n        if(child){\n            if(child.parentNode !== this.element){\n                throw new TypeError(`${child.outerHTML} is not a child of ${this.element.outerHTML}`);\n            }\n            child.classList.remove(this.selectID);\n            if(this.current === child){\n                this.current = null;\n            }\n        }\n        return this;\n    }\n    select(child){\n        if(child === null) return this;\n        child = getElement(child);\n\n        if(child.parentNode !== this.element){\n            throw new TypeError(`${child.outerHTML} is not a child of ${this.element.outerHTML}`);\n        }\n\n        if(child !== this.current){\n            child.classList.add(this.selectID);\n            this.current = child;\n        }\n        return this;\n    }\n    unSelectAll(){\n\n        arrayFrom(this.element.querySelectorAll('.'+this.selectID))\n        .forEach(child=>{\n            child.classList.remove(this.selectID);\n        });\n        this.current = null;\n        return this;\n    }\n    selectAll(){\n        let list = this.element.children;\n        for(let i=0; i<list.length; i++){\n            list[i].classList.add(this.selectID);\n        }\n        this.current = list[list.length - 1];\n        return this;\n    }\n}\n\nexport default function arrowSelect(element, options){\n    return new DOMArrowSelect(element, options);\n}\n"],"names":["let","this"],"mappings":"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"}