{"version":3,"file":"bundle.es.js","sources":["../src/lib/get_key.js","../src/lib/keys_mixin.js","../src/index.js"],"sourcesContent":["let keySet = {\n    '37': 'left',\n    '38': 'up',\n    '39': 'right',\n    '40': 'down'\n};\n\nexport default function getKey(keyCode){\n    return keySet[keyCode] || null;\n}\n","import events from 'dom-eve';\nimport rawObject from 'raw-object';\n\nconst keys = rawObject({\n    ctrl: false,\n    shift: false,\n    alt: false,\n    key: null,\n    keyCode: null,\n    which: null\n});\n\nconst enumerable = true;\nconst configurable = true;\n\nevents(document).on('keydown', event=>{\n    keys.ctrl = event.metaKey || event.ctrlKey;\n    keys.shift = event.shiftKey;\n    keys.alt = event.altKey;\n    keys.keyCode = keys.which = (event.which || event.keyCode)\n    keys.key = event.key;\n});\n\nevents(document).on('keyup', event=>{\n    keys.ctrl = keys.shift = keys.alt = false;\n    keys.key = keys.keyCode = keys.which = null;\n});\n\nfunction defineProp(dest, prop){\n    Object.defineProperty(dest, prop, {\n        get(){ return keys[prop]; },\n        enumerable,\n        configurable\n    });\n}\n\nexport function mixinKeys(dest){\n    for(let name in keys){\n        if(!dest.hasOwnProperty(name))\n            defineProp(dest, name);\n    }\n}\n\nexport function cleanKeysMixin(dest){\n    for(let name in keys){\n        delete dest[name];\n    }\n}\n","import events from 'dom-eve';\nimport domStep from 'dom-step';\nimport arrayFrom from 'array-from';\nimport getCorner from 'dom-get-corner';\nimport getElement from 'dom-get-element';\nimport getKey from './lib/get_key.js';\nimport { mixinKeys, cleanKeysMixin } from './lib/keys_mixin.js';\n\nclass DOMArrowSelect {\n    constructor({\n        selectID = 'dom-arrow-select-selected',\n        selected = function(next, prev){\n            this.unSelect(prev);\n            this.select(next);\n        },\n        outside = function(){},\n        step = function(){}\n    } = {}){\n\n        this.element = null;\n        this.current = null;\n        this._selected = selected;\n        this._outside = outside;\n        this._stepOpts = function(dir){\n            return step.call(this, dir) || {};\n        };\n\n        Object.defineProperty(this, 'selectID', {\n            value: selectID,\n            enumerable: true\n        });\n\n        mixinKeys(this);\n\n        const tracker = this.tracker = events.track();\n\n        events(document, tracker).on('keydown', event=>{\n\n            let element = this.element;\n            let key = getKey(event.which || event.keyCode);\n\n            if(key && element && element.parentNode){\n                this.step(key);\n            }\n        });\n\n        this.destroy = function(){\n            tracker.clear();\n            cleanKeysMixin(this);\n        };\n    }\n    step(key){\n        let element = this.element;\n        let el = this.current;\n        let next = null;\n        let {_stepOpts, _selected, _outside} = this;\n        let opts = _stepOpts.call(this, key);\n\n        if(!this.current){\n            next = getCorner(element, key, {\n                reverse:true,\n                xrange: opts.wrap,\n                yrange: opts.wrap\n            });\n        }else{\n            next = domStep(this.current, key, opts);\n        }\n\n        if(next){\n            _selected.call(\n                this,\n                next,\n                this.current\n            );\n        }else{\n            _outside.call(\n                this,\n                this.current,\n                key\n            );\n        }\n        return this;\n    }\n    focus(element){\n        if(!element){\n            this.element = element;\n            return this;\n        }\n        this.element = getElement(element);\n        return this;\n    }\n    focused(element){\n        if(!element) return false;\n        let el = getElement(element);\n        return this.element === el;\n    }\n    swap(element, direction){\n        if(typeof direction !== 'string'){\n            return this.unSelectAll().focus(element);\n        }\n        return this.unSelectAll().focus(element).step(direction);\n    }\n    unSelect(child){\n        if(child === null) return this;\n        if(!this.element) return this;\n        child = getElement(child);\n\n        if(child){\n            if(child.parentNode !== this.element){\n                throw new TypeError(`${child.outerHTML} is not a child of ${this.element.outerHTML}`);\n            }\n            child.classList.remove(this.selectID);\n            if(this.current === child){\n                this.current = null;\n            }\n        }\n        return this;\n    }\n    select(child){\n        if(child === null) return this;\n        if(!this.element) return this;\n        child = getElement(child);\n\n        if(child.parentNode !== this.element){\n            throw new TypeError(`${child.outerHTML} is not a child of ${this.element.outerHTML}`);\n        }\n\n        if(child !== this.current){\n            child.classList.add(this.selectID);\n            this.current = child;\n        }\n        return this;\n    }\n    unSelectAll(){\n\n        if(!this.element) return this;\n\n        arrayFrom(this.element.querySelectorAll('.'+this.selectID))\n        .forEach(child=>{\n            this.unSelect(child);\n        });\n        this.current = null;\n        return this;\n    }\n    selectAll(){\n        if(!this.element) return this;\n        let list = this.element.children;\n        for(let i=0; i<list.length; i++){\n            this.select(list[i]);\n        }\n        this.current = list[list.length - 1];\n        return this;\n    }\n    selectIndex(index){\n        if(!this.element) return this;\n        if(index < 0){\n            index = this.element.children.length + index;\n        }\n        this.select(this.element.children[index]);\n        return this;\n    }\n    unSelectIndex(index){\n        if(!this.element) return this;\n        if(index < 0){\n            index = this.element.children.length + index;\n        }\n        this.unSelect(this.element.children[index]);\n        return this;\n    }\n}\n\nexport default function arrowSelect(element, options){\n    return new DOMArrowSelect(element, options);\n}\n"],"names":["let","const","this"],"mappings":"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"}