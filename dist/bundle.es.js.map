{"version":3,"file":"bundle.es.js","sources":["../src/lib/get_key.js","../src/index.js"],"sourcesContent":["import rawObject from 'raw-object';\n\nlet keySet = rawObject({\n    '37': 'left',\n    '38': 'up',\n    '39': 'right',\n    '40': 'down'\n});\n\nexport default function getKey(keyCode){\n    return keySet[keyCode] || null;\n}\n","import events from 'dom-eve';\nimport domStep from 'dom-step';\nimport matches from 'matches-selector';\nimport arrayFrom from 'array-from';\nimport getCorner from 'dom-get-corner';\nimport getElement from 'dom-get-element';\nimport { mixinKeys, cleanKeysMixin } from 'dom-keys-mixin';\nimport { Emitter } from 'more-events';\nimport getKey from './lib/get_key.js';\n\nclass DOMArrowSelect extends Emitter {\n    constructor({\n        selectID = 'dom-arrow-select-selected',\n        selected = function(next, prev){\n            this.unSelect(prev);\n            this.select(next);\n        },\n        outside = function(){},\n        step = function(){},\n        classList = function(element){\n            return element.classList;\n        }\n    } = {}){\n        super();\n        this.element = null;\n        this.current = null;\n        this._selected = selected;\n        this._outside = outside;\n        this._classList = classList;\n        this._step = function(dir){\n            return step.call(this, dir) || {};\n        };\n\n        Object.defineProperty(this, 'selectID', {\n            value: selectID,\n            enumerable: true\n        });\n\n        mixinKeys(this);\n\n        const tracker = this.tracker = events.track();\n\n        events(document, tracker).on('keydown', event=>{\n\n            let element = this.element;\n            let key = getKey(event.which || event.keyCode);\n\n            if(key && element && element.parentNode){\n                this.step(key);\n            }\n        });\n\n        events(document, tracker).on('mousedown', event=>{\n            if(matches(event.target, '.'+selectID)){\n                this.emit('pointerdown', event.target);\n                event.stopPropagation();\n            }\n        });\n\n        events(document, tracker).on('keyup', event=>{\n            if(13 !== (event.which || event.keyCode)) return;\n\n            if(this.element.offsetHeight){\n                let elements = this.element.querySelectorAll('.'+selectID);\n                if(elements && elements.length){\n                    this.emit('focusenter', arrayFrom(elements));\n                }\n            }\n\n            let elements = document.querySelectorAll('.'+selectID);\n            if(elements && elements.length){\n                this.emit('enter', arrayFrom(elements));\n            }\n        });\n\n        this.destroy = function(){\n            tracker.clear();\n            cleanKeysMixin(this);\n        };\n    }\n    step(key){\n        let element = this.element;\n        let el = this.current;\n        let next = null;\n        let {_step, _selected, _outside} = this;\n        let opts = _step.call(this, key);\n\n        if(!this.current){\n            next = getCorner(element, key, {\n                reverse:true,\n                xrange: opts.wrap,\n                yrange: opts.wrap\n            });\n        }else{\n            next = domStep(this.current, key, opts);\n        }\n\n        if(next){\n            _selected.call(\n                this,\n                next,\n                this.current\n            );\n        }else{\n            _outside.call(\n                this,\n                this.current,\n                key\n            );\n        }\n        return this;\n    }\n    focus(element){\n        if(!element){\n            this.element = element;\n            return this;\n        }\n        this.element = getElement(element);\n        return this;\n    }\n    focused(element){\n        if(!element) return false;\n        let el = getElement(element);\n        return this.element === el;\n    }\n    swap(element, direction){\n        if(typeof direction !== 'string'){\n            return this.unSelectAll().focus(element);\n        }\n        return this.unSelectAll().focus(element).step(direction);\n    }\n    unSelect(child){\n        if(child === null) return this;\n        if(!this.element) return this;\n        child = getElement(child, this.element);\n\n        if(child){\n            if(child.parentNode !== this.element){\n                throw new TypeError(`${child.outerHTML} is not a child of ${this.element.outerHTML}`);\n            }\n            this._classList(child).remove(this.selectID);\n            if(this.current === child){\n                this.current = null;\n            }\n        }\n        return this;\n    }\n    select(child){\n        if(child === null) return this;\n        if(!this.element) return this;\n        child = getElement(child, this.element);\n\n        if(child.parentNode !== this.element){\n            throw new TypeError(`${child.outerHTML} is not a child of ${this.element.outerHTML}`);\n        }\n\n        if(child !== this.current){\n            this._classList(child).add(this.selectID);\n            this.current = child;\n        }\n        return this;\n    }\n    unSelectAll(){\n\n        if(!this.element) return this;\n\n        arrayFrom(this.element.querySelectorAll('.'+this.selectID))\n        .forEach(child=>{\n            this.unSelect(child);\n        });\n        this.current = null;\n        return this;\n    }\n    selectAll(){\n        if(!this.element) return this;\n        let list = this.element.children;\n        for(let i=0; i<list.length; i++){\n            this.select(list[i]);\n        }\n        this.current = list[list.length - 1];\n        return this;\n    }\n    selectIndex(index){\n        if(!this.element) return this;\n        if(index < 0){\n            index = this.element.children.length + index;\n        }\n        this.select(this.element.children[index]);\n        return this;\n    }\n    unSelectIndex(index){\n        if(!this.element) return this;\n        if(index < 0){\n            index = this.element.children.length + index;\n        }\n        this.unSelect(this.element.children[index]);\n        return this;\n    }\n}\n\nexport default function arrowSelect(element, options){\n    return new DOMArrowSelect(element, options);\n}\n"],"names":["let","super","const","this","elements"],"mappings":"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"}